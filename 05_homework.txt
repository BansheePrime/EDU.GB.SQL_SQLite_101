"""
Задание 5
Работаем с базой данных учителей teachers.db. 
Для каждого задания создайте запрос, сдать нужно только код запросов в текстовом файле. 
Для решения воспользуйтесь вложенными запросами и UNION.
"""
Исправил ошибку в названии таблицы:
ALTER TABLE cources_tb RENAME TO courses_tb;

1
(sqlite3) gidra@pop-os:~/Public/EDU.GB.SQL_SQLite_101$ sqlite3 ./teachers.db 
sqlite> .headers on
sqlite> .mode column  # для удобства
sqlite> SELECT stream_number, 
        (SELECT name FROM courses_tb WHERE id = course_id) as course_name, 
        students_number FROM streams_tb WHERE students_number >= 40;

        stream_number  course_name  students_number
        -------------  -----------  ---------------
        210            Базы данных  41  

/*****/ 

2. Найдите два потока с самыми низкими значениями успеваемости. 
В отчет выведите номер потока, название курса, фамилию и имя преподавателя (одним столбцом), оценку успеваемости.
2
sqlite> SELECT stream_number, 
        (SELECT name FROM courses_tb WHERE id = course_id) as course_name,
        (SELECT surname FROM teachers_tb WHERE id = course_id) as teacher_name,
        (SELECT grade FROM grades_tb WHERE teacher_id = course_id) as grade
        FROM streams_tb
        ORDER BY grade ASC
        LIMIT 2;

        stream_number  course_name             teacher_name  grade
        -------------  ----------------------  ------------  -----
        165            Linux. Рабочая станция  Малышева      4.7  
        203            Базы данных             Савельев      4.8  


/*****/ 

3. Найдите среднюю успеваемость всех потоков преподавателя Николая Савельева. 
В отчёт выведите идентификатор преподавателя и среднюю оценку по потокам.
3
sqlite> SELECT
        (SELECT id FROM teachers_tb WHERE name = 'Николай' and surname = 'Савельев') AS id,
        (SELECT AVG(grade) AS needed_avg FROM grades_tb WHERE teacher_id = 
                (SELECT id FROM teachers_tb WHERE name = 'Николай' and surname = 'Савельев')
        ) AS avg_grade;

        id  avg_grade
        --  ---------
        1   4.85
/*****/ 

4. Найдите потоки преподавателя Натальи Петровой, а также потоки, по которым успеваемость ниже 4.8. 
В отчёт выведите идентификатор потока, фамилию и имя преподавателя.
4
sqlite> 

/*****/ 

5. Дополнительное задание. 
Найдите разницу между средней успеваемостью преподавателя с наивысшим соответствующим значением и 
средней успеваемостью преподавателя с наименьшим значением. 
Средняя успеваемость считается по всем потокам преподавателя.
5
sqlite> 

/*****/ 
