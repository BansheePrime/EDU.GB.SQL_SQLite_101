"""
Задание 5
Работаем с базой данных учителей teachers.db. 
Для каждого задания создайте запрос, сдать нужно только код запросов в текстовом файле. 
Для решения воспользуйтесь вложенными запросами и UNION.
"""
1
(sqlite3) gidra@pop-os:~/Public/EDU.GB.SQL_SQLite_101$ sqlite3 ./teachers.db 
sqlite> .headers on
sqlite> .mode column  # для удобства
sqlite> SELECT stream_number, 
        (SELECT name FROM cources_tb WHERE id = course_id) as course_name, 
        students_number FROM streams_tb WHERE students_number >= 40;

        stream_number  course_name  students_number
        -------------  -----------  ---------------
        210            Базы данных  41  

/*****/ 

2. Найдите два потока с самыми низкими значениями успеваемости. 
В отчет выведите номер потока, название курса, фамилию и имя преподавателя (одним столбцом), оценку успеваемости.
2
sqlite> SELECT stream_number, 
        (SELECT name FROM cources_tb WHERE id = course_id) as course_name,
        'teacher_names',
        (SELECT grade FROM grades_tb WHERE) AS grade_data
        FROM streams_tb;

/*****/ 

3. Найдите среднюю успеваемость всех потоков преподавателя Николая Савельева. 
В отчёт выведите идентификатор преподавателя и среднюю оценку по потокам.
3
sqlite> 
select teacher_id, AVG(grade) AS avg FROM grades_tb group by teacher_id;
select id from teachers_tb where name = 'Николай' AND surname = 'Савельев';

select teacher_id, AVG(grade) AS avg FROM grades_tb where id = lsv_id (select id from teachers_tb where name = 'Николай' AND surname = 'Савельев') as lsv_id group by teacher_id;
select id from teachers_tb where name = 'Николай' AND surname = 'Савельев';

select 'teacher_surname', 'teacher_name', 'course_name', grade from grades_tb;
sqlite> .width 15 12 11 6

select
(select name from teachers_tb where id = teacher_id) as teacher_name,
(select surname from teachers_tb where id = teacher_id) as teacher_surname,
(select name from cources_tb where id =
(select course_id from streams_tb where id = course_id)) as course_name,
grade from grades_tb;


/*****/ 

4. Найдите потоки преподавателя Натальи Петровой, а также потоки, по которым успеваемость ниже 4.8. 
В отчёт выведите идентификатор потока, фамилию и имя преподавателя.
4
sqlite> 

/*****/ 

5. Дополнительное задание. 
Найдите разницу между средней успеваемостью преподавателя с наивысшим соответствующим значением и 
средней успеваемостью преподавателя с наименьшим значением. 
Средняя успеваемость считается по всем потокам преподавателя.
5
sqlite> 

/*****/ 
